{% extends "base.html" %}

{% block title %}Session{% endblock %}

	<div class="container-fluid mt-5">
    {% block content %}
        <button class="btn btn-info" id="checkout-button">Stripe</button>
    {% endblock %}
	</div>




	<script type="text/javascript">
		// Create an instance of the Stripe object with your publishable API key
		var stripe = Stripe("pk_test_51IXqAwIBBCpvms2A0tZdmSSd78uaVKdZ86iOhZrbKAxO4uf41sgvHWyp6q71h11shWh0ZNFR1BLZBnzmgzSKWd8a00T1RT6ZMQ");
		var checkoutButton = document.getElementById("checkout-button");
		checkoutButton.addEventListener("click", function () {
		  fetch("{% url 'sub:sub-session' %}", {
			method: "POST",
			headers: {
				'X-CSRFToken': csrftoken,
			}
		  })
			.then(function (response) {
			  return response.json();
			})
			.then(function (session) {
			  return stripe.redirectToCheckout({ sessionId: session.id });res.json
			})
			.then(function (result) {
			  // If redirectToCheckout fails due to a browser or network
			  // error, you should display the localized error message to your
			  // customer using error.message.
			  if (result.error) {
				alert(result.error.message);
			  }
			})
			.catch(function (error) {
			  console.error("Error:", error);
			});
		});
	</script>

